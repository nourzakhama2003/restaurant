<div class="menu-items-container">
    
    <div class="menu-items-header">
        <div class="header-content">
            <div class="header-title-section">
                <div class="title-icon">
                    <mat-icon>restaurant_menu</mat-icon>
                </div>
                <div class="title-content">
                    <h1 class="page-title">Gestion des Plats</h1>
                    <p class="page-subtitle">Gérez tous vos plats et menus</p>
                </div>
            </div>
            <button class="add-menu-item-btn" (click)="addItem()">
                <mat-icon>add</mat-icon>
                <span>Nouveau Plat</span>
            </button>
        </div>
    </div>

    <div class="search-filter-section">
        <div class="search-container">
            <div class="search-input-wrapper">
                <mat-icon class="search-icon">search</mat-icon>
                <input type="text" class="search-input" placeholder="Rechercher par nom, description ou restaurant..." [(ngModel)]="searchText" />
                <button *ngIf="searchText" class="clear-search-btn" (click)="clearSearch()" mat-icon-button>
                    <mat-icon>close</mat-icon>
                </button>
            </div>
        </div>
        <div class="filters-row">
            <div class="filter-group">
                <label class="filter-label">
                    <mat-icon>category</mat-icon>
                    Catégorie
                </label>
                <mat-form-field appearance="outline" class="category-select">
                    <mat-select [(ngModel)]="selectedCategoryId">
                        <mat-option value="">Toutes les catégories</mat-option>
                        <mat-option *ngFor="let cat of categories" [value]="cat.id">
                            {{ cat.name }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="filter-info" *ngIf="searchText || selectedCategoryId">
                <mat-icon>filter_list</mat-icon>
                <span>{{ filteredMenuItems.length }} plat(s) trouvé(s)</span>
            </div>
        </div>
    </div>

    <div class="menu-items-content">
        <div *ngIf="isLoading" class="loading-state">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Chargement des plats...</p>
        </div>

        <div *ngIf="!isLoading && filteredMenuItems.length === 0" class="empty-state">
            <div class="empty-icon">
                <mat-icon>restaurant_menu</mat-icon>
            </div>
            <h3>Aucun plat trouvé</h3>
            <p *ngIf="searchText || selectedCategoryId">Aucun plat ne correspond à vos critères de recherche.</p>
            <p *ngIf="!searchText && !selectedCategoryId">Commencez par créer votre premier plat.</p>
            <button *ngIf="!searchText && !selectedCategoryId" class="create-first-btn" (click)="addItem()">
                <mat-icon>add</mat-icon>
                Créer le premier plat
            </button>
        </div>

        <div *ngIf="!isLoading && filteredMenuItems.length > 0" class="menu-items-grid">
            <div class="menu-item-card" *ngFor="let item of filteredMenuItems; let i = index" [@fadeInUp] [style.animation-delay]="(i * 100) + 'ms'">
                <div class="card-header">
                    <div class="item-image">
                        <img [src]="getItemImage(item)" [alt]="item.name" />
                        <div class="image-overlay">
                            <mat-icon>photo_camera</mat-icon>
                        </div>
                    </div>
                    <div class="price-badge">
                        <span>{{ item.price | number:'1.2-2' }} TND</span>
                    </div>
                </div>

                <div class="card-content">
                    <h3 class="item-name">{{ item.name }}</h3>
                    <p class="item-description">{{ item.description || 'Aucune description' }}</p>

                    <div class="item-details">
                        <div class="detail-item">
                            <mat-icon>restaurant</mat-icon>
                            <span>{{ getRestaurantName(item.restaurantId) }}</span>
                        </div>
                        <div class="detail-item" *ngIf="getCategoryName(item.categoryId)">
                            <mat-icon>category</mat-icon>
                            <span>{{ getCategoryName(item.categoryId) }}</span>
                        </div>
                    </div>
                </div>

                <div class="card-actions">
                    <button class="action-btn edit-btn" (click)="editItem(item)" matTooltip="Modifier le plat">
                        <mat-icon>edit</mat-icon>
                    </button>
                    <button class="action-btn delete-btn" (click)="delete(item.id)" matTooltip="Supprimer le plat">
                        <mat-icon>delete</mat-icon>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>